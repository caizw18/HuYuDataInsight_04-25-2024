Data1 <- read.csv(file = "./data1.csv")

model1 <- lm(Y ~., data = Data1)
summary(model1)
# Coefficients:
#              Estimate   Std. Error  t value  Pr(>|t|)    
# (Intercept)  4.9548686  0.2645160  18.732  < 2e-16 ***
# E1           0.2719673  0.0122721  22.161  < 2e-16 ***
# E2           0.3718574  0.0121974  30.487  < 2e-16 ***
# E3          -0.0019147  0.0121031  -0.158  0.87433    
# E4           0.0088911  0.0124546   0.714  0.47547    
# E5           0.0329448  0.0122872   2.681  0.00746 ** 
# E6           0.0097183  0.0117727   0.825  0.40930    
# E7          -0.0029228  0.0120685  -0.242  0.80869    
# E8          -0.0030709  0.0121125  -0.254  0.79991    
# G1           0.0040139  0.0383393   0.105  0.91664    
# G2          -0.0908020  0.0381531  -2.380  0.01751 *  
# G3           0.4680513  0.0381540  12.267  < 2e-16 ***
# G4          -0.0007821  0.0379812  -0.021  0.98357    
# G5           0.0298067  0.0395337   0.754  0.45106    
# G6           0.0216680  0.0386565   0.561  0.57525    
# G7          -0.0347455  0.0387077  -0.898  0.36960    
# G8           0.0025229  0.0388880   0.065  0.94829    
# G9          -0.0070478  0.0382222  -0.184  0.85375    
# G10         -0.0127438  0.0388126  -0.328  0.74272    
# G11         -0.0791773  0.0381862  -2.073  0.03840 *  
# G12         -0.0285955  0.0386884  -0.739  0.46001    
# G13          0.3050042  0.0387090   7.879 8.87e-15 ***
# G14          0.0302477  0.0385430   0.785  0.43278    
# G15         -0.0118879  0.0383020  -0.310  0.75635    
# G16         -0.0690015  0.0383067  -1.801  0.07197 .  
# G17          0.0335088  0.0376429   0.890  0.37359    
# G18         -0.0125862  0.0377432  -0.333  0.73885    
# G19         -0.0147937  0.0394917  -0.375  0.70804    
# G20         -0.0852220  0.0379864  -2.243  0.02509 *  
# G21          0.0082619  0.0377598   0.219  0.82685    
# G22         -0.0709709  0.0373065  -1.902  0.05742 .  
# G23         -0.0547853  0.0379699  -1.443  0.14939    
# G24          0.2480729  0.0388104   6.392 2.55e-10 ***
# G25          0.0311344  0.0383549   0.812  0.41714    
# G26         -0.0320573  0.0383210  -0.837  0.40306    
# G27          0.0397126  0.0382197   1.039  0.29904    
# G28          0.3293814  0.0383254   8.594  < 2e-16 ***
# G29          0.0113550  0.0376895   0.301  0.76327    
# G30          0.0133474  0.0381672   0.350  0.72663    

# E1 E2 E5 G3 G13 G24 G28

library(psych)
corr.test(Data1,
          use    = "pairwise",
          method = "pearson",
          adjust = "none")

library(MASS)

#find optimal lambda for Box-Cox transformation 
par(mfrow=c(1,2))
bc <- boxcox(model1, lambda = seq(-2, 2, 1/10))
hist(Data1$Y)
lambda <- bc$x[which.max(bc$y)]
# lambda = 0.9494949, 1

full.model<-lm(Y ~ E1 + E2 + E5 + G3 + G13 + G24 + G28 + E1:E2 + 
                 E1:E5 + E2:E5 + E1:G3 + E2:G3 + E5:G3 + E1:G13 + E2:G13 + 
                 E5:G13 + G3:G13 + E1:G24 + E2:G24 + E5:G24 + G3:G24 + G13:G24 + 
                 E1:G28 + E2:G28 + E5:G28 + G3:G28 + G13:G28 + G24:G28 + E1:E2:E5 + 
                 E1:E2:G3 + E1:E5:G3 + E2:E5:G3 + E1:E2:G13 + E2:E5:G13 + 
                 E1:G3:G13 + E2:G3:G13 + E5:G3:G13 + E1:E2:G24 + E1:E5:G24 + 
                 E2:E5:G24 + E1:G3:G24 + E2:G3:G24 + E5:G3:G24 + E1:G13:G24 + 
                 E2:G13:G24 + E5:G13:G24 + G3:G13:G24 + E1:E2:G28 + E1:E5:G28 + 
                 E2:E5:G28 + E1:G3:G28 + E2:G3:G28 + E5:G3:G28 + E1:G13:G28 + 
                 E2:G13:G28 + E5:G13:G28 + G3:G13:G28 + E1:G24:G28 + E2:G24:G28 + 
                 E5:G24:G28 + G3:G24:G28 + G13:G24:G28 + E1:E2:E5:G3 + E1:E2:G3:G13 + 
                 E2:E5:G3:G13 + E1:E2:E5:G24 + E1:E2:G3:G24 + E2:E5:G3:G24 + 
                 E1:E2:G13:G24 + E2:E5:G13:G24 + E1:G3:G13:G24 + E2:G3:G13:G24 + 
                 E5:G3:G13:G24 + E1:E2:E5:G28 + E1:E2:G3:G28 + E1:E5:G3:G28 + 
                 E2:E5:G3:G28 + E1:E2:G13:G28 + E2:E5:G13:G28 + E2:G3:G13:G28 + 
                 E5:G3:G13:G28 + E1:E2:G24:G28 + E1:E5:G24:G28 + E2:E5:G24:G28 + 
                 E2:G3:G24:G28 + E5:G3:G24:G28 + E1:G13:G24:G28 + E2:G13:G24:G28 + 
                 E5:G13:G24:G28 + G3:G13:G24:G28, data = Data1)

#Perform stepwise regression in both directions
step.model<-stepAIC(full.model, direction="both", trace = F)
summary(step.model)

# Residuals:
# Min       1Q   Median       3Q      Max 
# -1.56059 -0.28871  0.00116  0.32139  1.37112 

# Coefficients:  Estimate Std. Error t value Pr(>|t|)    
# (Intercept)    -1.878547   2.551949  -0.736 0.461838    
# E1              1.185918   0.326216   3.635 0.000292 ***
# E2              1.299477   0.335102   3.878 0.000113 ***
# E5              0.730061   0.314382   2.322 0.020432 *  
# G3              3.090161   1.197818   2.580 0.010034 *  
# G13             1.580046   0.969986   1.629 0.103658    
# G24             0.341223   1.179975   0.289 0.772508    
# G28            -1.031905   1.041124  -0.991 0.321867    
# E1:E2          -0.124108   0.042916  -2.892 0.003917 ** 
# E1:E5          -0.095127   0.040351  -2.358 0.018599 *  
# E2:E5          -0.091591   0.041254  -2.220 0.026641 *  
# E1:G3          -0.224947   0.151095  -1.489 0.136877    
# E2:G3          -0.262960   0.150377  -1.749 0.080670 .  
# E5:G3          -0.063783   0.034407  -1.854 0.064081 .  
# E1:G13         -0.232713   0.124281  -1.872 0.061446 .  
# E2:G13         -0.311335   0.121301  -2.567 0.010421 *  
# E5:G13          0.051746   0.034264   1.510 0.131326    
# G3:G13          1.037644   0.482957   2.149 0.031924 *  
# E1:G24         -0.098275   0.146731  -0.670 0.503171    
# E2:G24         -0.096250   0.144498  -0.666 0.505507    
# E5:G24         -0.004527   0.034042  -0.133 0.894230    
# G3:G24         -3.161743   2.176797  -1.452 0.146699    
# G13:G24         1.693056   0.759157   2.230 0.025968 *  
# E1:G28          0.179869   0.130023   1.383 0.166878    
# E2:G28          0.178544   0.131914   1.353 0.176222    
# E5:G28         -0.042205   0.028574  -1.477 0.139994    
# G3:G28         -0.787653   0.401456  -1.962 0.050055 .  
# G13:G28         0.896877   0.480508   1.867 0.062277 .  
# G24:G28         0.772782   0.472888   1.634 0.102553    
# E1:E2:E5        0.012769   0.005313   2.404 0.016425 *  
# E1:E2:G3        0.027358   0.019717   1.388 0.165614    
# E1:E2:G13       0.037586   0.015884   2.366 0.018168 *  
# E5:G3:G13      -0.159157   0.064754  -2.458 0.014154 *  
# E1:E2:G24       0.017950   0.018643   0.963 0.335859    
# E1:G3:G24       0.434451   0.276859   1.569 0.116931    
# E2:G3:G24       0.434051   0.274640   1.580 0.114339    
# E5:G3:G24      -0.042857   0.065998  -0.649 0.516260    
# E1:G13:G24     -0.045829   0.059753  -0.767 0.443285    
# E2:G13:G24     -0.081793   0.051824  -1.578 0.114833    
# E5:G13:G24     -0.026837   0.061917  -0.433 0.664795    
# G3:G13:G24     -1.393789   0.843112  -1.653 0.098631 .  
# E1:E2:G28      -0.023661   0.016904  -1.400 0.161917    
# E5:G3:G28       0.077599   0.052498   1.478 0.139706    
# E1:G13:G28     -0.056301   0.061972  -0.908 0.363847    
# G3:G13:G28      0.245294   0.161277   1.521 0.128605    
# E1:G24:G28     -0.016269   0.060968  -0.267 0.789650    
# G13:G24:G28     1.559848   0.854505   1.825 0.068248 .  
# E1:E2:G3:G24   -0.054649   0.035782  -1.527 0.127020    
# E5:G3:G13:G24   0.223141   0.113074   1.973 0.048738 *  
# E1:G13:G24:G28 -0.169553   0.111029  -1.527 0.127068    
# Residual standard error: 0.4766 on 951 degrees of freedom
# Multiple R-squared:  0.7421,	Adjusted R-squared:  0.7288 
# F-statistic: 55.85 on 49 and 951 DF,  p-value: < 2.2e-16

# E1 E2 E5 G3 E1:E2 E1:E5 E2:E5 E2:G13 G3:G13 G13:G24 E1:E2:E5 E1:E2:G13 
# E5:G3:G13 E5:G3:G13:G24

full.model2<-lm(Y ~ E1 + E2 + E5 + G3 + E1:E2 + E1:E5 + E2:E5 + 
                    E2:G13 + G3:G13 + G13:G24 + E1:E2:E5 + E1:E2:G13 + 
                    E5:G3:G13 + E5:G3:G13:G24, data = Data1)

step.model2<-stepAIC(full.model2, direction="both", trace = F)
summary(step.model2)

# Residuals:
# Min      1Q  Median      3Q     Max 
# -1.8617 -0.3694  0.0047  0.3539  2.0155 

# Coefficients: Estimate Std. Error t value Pr(>|t|)    
# (Intercept)   -0.466911   2.619109  -0.178 0.858547    
# E1             1.002617   0.336833   2.977 0.002986 ** 
# E2             1.143469   0.345064   3.314 0.000954 ***
# E5             0.693968   0.342062   2.029 0.042749 *  
# G3             0.425353   0.044895   9.474  < 2e-16 ***
# E1:E2         -0.100655   0.044446  -2.265 0.023750 *  
# E1:E5         -0.087091   0.044038  -1.978 0.048246 *  
# E2:E5         -0.091326   0.044944  -2.032 0.042423 *  
# E2:G13        -0.025936   0.026088  -0.994 0.320382    
# G3:G13         0.821038   0.322678   2.544 0.011097 *  
# G13:G24        0.660858   0.081688   8.090 1.74e-15 ***
# E1:E2:E5       0.011941   0.005796   2.060 0.039652 *  
# E1:E2:G13      0.004972   0.003404   1.461 0.144439    
# E5:G3:G13     -0.116667   0.044232  -2.638 0.008480 ** 
# E5:G3:G13:G24  0.028114   0.019507   1.441 0.149843    
# Residual standard error: 0.5454 on 986 degrees of freedom
# Multiple R-squared:  0.6499,	Adjusted R-squared:  0.6449 
# F-statistic: 130.7 on 14 and 986 DF,  p-value: < 2.2e-16

# E1  E2  G3  G13:G24  E5:G3:G13

full.model3<-lm(Y ~ E1 + E2 + G3 + G13:G24 + E5:G3:G13, data = Data1)
step.model3<-stepAIC(full.model3, direction="both", trace = F)
summary(step.model3)

# Residuals:
# Min       1Q   Median       3Q      Max 
# -1.86253 -0.37659  0.01102  0.36064  2.18949 

# Coefficients: Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  5.26490    0.13294   39.60   <2e-16 ***
# E1           0.27583    0.01204   22.90   <2e-16 ***
# E2           0.38041    0.01205   31.58   <2e-16 ***
# G3           0.44025    0.03777   11.66   <2e-16 ***
# G13:G24      0.78348    0.05978   13.11   <2e-16 ***
# Residual standard error: 0.5482 on 996 degrees of freedom
# Multiple R-squared:  0.6428,	Adjusted R-squared:  0.6413 
# F-statistic:   448 on 4 and 996 DF,  p-value: < 2.2e-16

par(mfrow=c(2,2)) 
plot(step.model3)

anova(step.model3)